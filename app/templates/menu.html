<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Transportima - Menu</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" />
    <style>
      :root {
        --primary: #8a48f4;
        --accent: #ffb712;
        --bg: #121212;
        --text: #ffffff;
        --card: #1f1f1f;
      }

      body {
        background-color: var(--bg);
        color: var(--text);
        font-family: 'Poppins', sans-serif;
        margin: 0;
        padding: 0;
      }

      .navbar {
        background-color: var(--primary);
        padding: 1rem;
      }

      .navbar-brand img {
        height: 40px;
      }

      .nav-link {
        color: #fff;
        margin: 0 1rem;
        font-weight: 500;
      }

      .nav-link:hover,
      .nav-link.active {
        color: var(--accent);
      }

      .container-form {
        margin: 4rem auto 2rem;
        max-width: 700px;
        background: var(--card);
        padding: 2rem;
        border-radius: 10px;
      }

      .form-label {
        margin-bottom: 0.5rem;
        font-weight: 500;
      }

      .form-control {
        border-radius: 8px;
        border: 1px solid #ccc;
        padding: 0.75rem;
        background-color: #fffefe;
        color: var(--text);
        margin-bottom: 1rem;
      }

      .dropdown-menu {
        max-height: 200px;
        overflow-y: auto;
        background-color: #fffefe;
      }

      .dropdown-item {
        color: white;
        cursor: pointer;
      }

      .dropdown-item:hover {
        background-color: var(--accent);
        color: #000;
      }

      .btn-custom {
        background: var(--primary);
        border: none;
        color: white;
        padding: 10px 25px;
        border-radius: 20px;
        display: block;
        width: 100%;
      }

      .btn-custom:hover {
        background: var(--accent);
        color: #000;
      }

      .results {
        margin: 3rem auto;
        max-width: 1000px;
        display: flex;
        justify-content: center;
        flex-wrap: wrap;
        gap: 2rem;
      }

      .card-mode {
        background: var(--card);
        border: none;
        border-radius: 10px;
        width: 240px;
        padding: 1.5rem;
        text-align: center;
      }

      .card-mode img {
        width: 60px;
        margin-bottom: 1rem;
      }

      #route_path {
        font-weight: 600;
        margin: 2rem auto;
        text-align: center;
      }

      footer {
        background: var(--primary);
        color: white;
        padding: 1rem;
        text-align: center;
        margin-top: 2rem;
      }

      /* Modal Styles */
      .overlay {
        position: fixed;
        top: 0;
        left: 0;
        height: 100%;
        width: 100%;
        background: rgba(0, 0, 0, 0.5);
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.3s ease;
        z-index: 999;
      }

      .overlay.active {
        opacity: 1;
        pointer-events: auto;
      }

      .modal-box {
        position: fixed;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%) scale(0.8);
        background-color: var(--card);
        color: var(--text);
        padding: 2rem;
        border-radius: 10px;
        width: 90%;
        max-width: 500px;
        z-index: 1000;
        opacity: 0;
        pointer-events: none;
        transition: all 0.3s ease;
      }

      .modal-box.active {
        opacity: 1;
        pointer-events: auto;
        transform: translate(-50%, -50%) scale(1);
      }

      .modal-box h2 {
        font-size: 1.5rem;
        margin-bottom: 1rem;
      }

      .modal-box ol {
        padding-left: 1rem;
      }

      .modal-box .buttons {
        text-align: center;
        margin-top: 1.5rem;
      }

      .modal-box .close-btn {
        padding: 0.5rem 1rem;
        border: none;
        background: var(--accent);
        color: black;
        border-radius: 5px;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg">
      <div class="container">
        <a class="navbar-brand" href="#">
          <img src="{{ url_for('static', filename='assets/TransportimaP.png') }}" alt="Logo" />
        </a>
        <ul class="navbar-nav ms-auto">
          <li class="nav-item">
            <a class="nav-link" href="{{ url_for('home') }}">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="{{ url_for('menu') }}">Menu</a>
          </li>
        </ul>
      </div>
    </nav>

    <!-- Modal Box -->
    <section id="modalBox">
      <span class="overlay"></span>
      <div class="modal-box">
        <h2>Attention</h2>
        <h3>
          <ol>
            <li>Make sure you have a destination in a regional city of Central Java Province</li>
            <li>Specify your initial destination by selecting an available city</li>
            <li>Specify your final destination by selecting an available city</li>
            <li>Press the submit button</li>
            <li>The distance will appear in the box of each transportation mode</li>
            <li>ENJOY YOUR TRIP</li>
          </ol>
        </h3>
        <div class="buttons">
          <button class="close-btn">Close</button>
        </div>
      </div>
    </section>

    <section class="container-form">
      <button type="button" class="btn btn-secondary mb-3" onclick="showModal()">Show Info</button>
      <form onsubmit="process(event)">
        <div class="mb-3">
          <label for="startCity" class="form-label">Start City</label>
          <input type="text" class="form-control" id="startCity" name="startCity" placeholder="Type to search..." list="cityList" required>
        </div>
        <div class="mb-3">
          <label for="finishCity" class="form-label">Finish City</label>
          <input type="text" class="form-control" id="finishCity" name="finishCity" placeholder="Type to search..." list="cityList" required>
        </div>
        <datalist id="cityList">
          {% for city in cities %}
          <option value="{{ city|capitalize }}"></option>
          {% endfor %}
        </datalist>
        <button type="submit" class="btn btn-custom">Find Route</button>
      </form>
    </section>

    <section class="results">
      <div class="card-mode">
        <img src="{{ url_for('static', filename='assets/iconmotor1.png') }}" alt="Motorcycle" />
        <h5>Motorcycle</h5>
        <p id="motorcycle">... KM</p>
      </div>
      <div class="card-mode">
        <img src="{{ url_for('static', filename='assets/iconcar.png') }}" alt="Car" />
        <h5>Car</h5>
        <p id="car">... KM</p>
      </div>
      <div class="card-mode">
        <img src="{{ url_for('static', filename='assets/icontrain.png') }}" alt="Train" />
        <h5>Train</h5>
        <p id="train">... KM</p>
      </div>
    </section>

    <div id="route_path">Route: ...</div>

    <section class="city-list">
      <div class="container">
        <h5 class="text-center mb-4">Available Cities in Central Java</h5>
        <div class="row row-cols-1 row-cols-md-3 g-3">
          {% set city_names = [
            'Wonogiri', 'Sukoharjo', 'Karanganyar', 'Klaten', 'Boyolali', 'Surakarta',
            'Sragen', 'Grobogan', 'Semarang', 'Kota Semarang', 'Demak', 'Kudus',
            'Pati', 'Blora', 'Rembang', 'Jepara', 'Magelang', 'Kota Magelang',
            'Temanggung', 'Kendal', 'Kota Salatiga', 'Purworejo', 'Wonosobo', 'Batang',
            'Banjarnegara', 'Pekalongan', 'Kota Pekalongan', 'Kebumen', 'Cilacap',
            'Banyumas', 'Purbalingga', 'Brebes', 'Tegal', 'Kota Tegal', 'Pemalang'
          ] %}
          {% for city in city_names %}
          <div class="col">
            <div class="p-2 ps-3 rounded bg-dark bg-opacity-10">
              <span>â€¢</span> {{ city }}
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
    </section>

    <footer>
      <img src="{{ url_for('static', filename='assets/TransportimaP.png') }}" height="30" />
      <p class="mt-2">&copy; 2025 Transportima</p>
    </footer>

    <script>
      async function process(event) {
        event.preventDefault();
        const startCity = document.getElementById('startCity').value;
        const finishCity = document.getElementById('finishCity').value;
        const res = await fetch('/api/process', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ start: startCity, finish: finishCity })
        });
        const data = await res.json();
        document.getElementById('motorcycle').innerText = `${data.shortest_path_length} KM`;
        document.getElementById('car').innerText = `${data.shortest_path_length_car} KM`;
        document.getElementById('train').innerText = `${data.shortest_path_length_train} KM`;
        document.getElementById('route_path').innerText = `Route: ${data.route_path}`;
      }

      function showModal() {
        document.querySelector('.overlay').classList.add('active');
        document.querySelector('.modal-box').classList.add('active');
      }

      document.querySelector('.close-btn').addEventListener('click', () => {
        document.querySelector('.overlay').classList.remove('active');
        document.querySelector('.modal-box').classList.remove('active');
      });

      document.querySelector('.overlay').addEventListener('click', () => {
        document.querySelector('.overlay').classList.remove('active');
        document.querySelector('.modal-box').classList.remove('active');
      });
    </script>
  </body>
</html>